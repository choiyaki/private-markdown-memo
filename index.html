<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
  >
  <title>Debug Memo</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/theme/dracula.min.css">

  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      background: #f5f5f7;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
			overscroll-behavior: none;
    }

    /* ===== ãƒ˜ãƒƒãƒ€ãƒ¼ ===== */
    #header-container {
      position: fixed;
      top: env(safe-area-inset-top);
      left: 0;
      right: 0;
      height: 30px;
      padding: 8px 12px;
      background: #ffffff;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid #d1d1d6;
      z-index: 1000;
      transform: translateZ(0);
    }

    .header-side {
      width: 44px;
      display: flex;
      justify-content: flex-end;
    }

    #title-field {
      flex-grow: 1;
      max-width: 200px;
      height: 30px;
      padding: 0 6px;
      font-size: 16px;
      background: #f2f2f7;
      border: none;
      border-radius: 5px;
      outline: none;
      color: #1c1c1e;
      font-weight: 700;
      text-align: center;
    }

    #export-all-btn {
      background: none;
      border: none;
      font-size: 20px;
      padding: 4px;
      color: #007aff;
      cursor: pointer;
    }

    /* ===== ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ ===== */
    #toolbar {
      position: fixed;
      top: calc(47px + env(safe-area-inset-top));
      left: 0;
      right: 0;
      height: 30px;
      display: flex;
      gap: 8px;
      padding: 4px;
      background: #f5f5f7;
      border-bottom: 1px solid #d1d1d6;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      z-index: 900;
    }

    #toolbar button {
      height: 27px;
      min-width: 35px;
      font-size: 14px;
      background: #f2f2f7;
      color: #007aff;
      border: 1px solid #d1d1d6;
      border-radius: 8px;
      flex-shrink: 0;
    }

    #toolbar .separator {
      width: 1px;
      background: #d1d1d6;
      margin: 6px 2px;
    }

    .spacer {
      flex-grow: 1;
    }

    /* ===== ã‚¨ãƒ‡ã‚£ã‚¿ ===== */
   #editor-container {
  position: absolute;
  top: calc(88px + env(safe-area-inset-top));
  left: 0;
  right: 0;
  bottom: 0;          /* â† ã“ã‚Œã‚’åŸºæº–ã«ã™ã‚‹ */
  background: #ffffff;
  overflow: hidden;
	overscroll-behavior: none;
}

    .CodeMirror {
      height: 100% !important;
      font-size: 14px;
      line-height: 1.6;
    }
		.CodeMirror-line {
    /* å…¨ã¦ã®è¡Œã‚’ã€ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ¬ãƒ™ãƒ«ã«å¿œã˜ãŸåˆ†ã ã‘å³ã«å¯„ã›ã‚‹ */
    /* 0.55em ã¯ 12px ã«ãŠã‘ã‚‹åŠè§’ã‚¹ãƒšãƒ¼ã‚¹ã®å¹…ã«æ¥µã‚ã¦è¿‘ã„æ•°å€¤ã§ã™ */
    padding-left: calc(var(--indent-level, 0) * 1em + 0.7em) !important;
    
    /* 1è¡Œç›®ã ã‘ã€CodeMirrorãŒæŒ¿å…¥ã—ãŸã€Œç‰©ç†çš„ãªç©ºç™½ã€ã®åˆ†ã ã‘å·¦ã«æˆ»ã™ */
    /* ã“ã‚Œã§ã€Œç‰©ç†ç©ºç™½ã€ã¨ã€Œpaddingã€ãŒç›¸æ®ºã•ã‚Œã€2è¡Œç›®ã¨æ–‡é ­ãŒæƒã„ã¾ã™ */
    text-indent: calc(var(--indent-level, 0) * -0.6em) !important;
    
    position: relative;
    display: block;
		padding-bottom: env(safe-area-inset-bottom);
}

.CodeMirror-scroll {
  padding-bottom: 40vh; /* â† ã“ã‚ŒãŒåŠ¹ã */
}


/* 2. ã¶ã‚‰ä¸‹ã’ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã®å†å®šç¾© */
.CodeMirror-line:has(.cm-variable-2, .cm-variable-3, .cm-comment) {
    /* å…¨ã¦ã®è¡Œã‚’ã€ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ¬ãƒ™ãƒ«ã«å¿œã˜ãŸåˆ†ã ã‘å³ã«å¯„ã›ã‚‹ */
    /* 0.55em ã¯ 12px ã«ãŠã‘ã‚‹åŠè§’ã‚¹ãƒšãƒ¼ã‚¹ã®å¹…ã«æ¥µã‚ã¦è¿‘ã„æ•°å€¤ã§ã™ */
    padding-left: calc(var(--indent-level, 0) * 1em + 2em) !important;
    
    /* 1è¡Œç›®ã ã‘ã€CodeMirrorãŒæŒ¿å…¥ã—ãŸã€Œç‰©ç†çš„ãªç©ºç™½ã€ã®åˆ†ã ã‘å·¦ã«æˆ»ã™ */
    /* ã“ã‚Œã§ã€Œç‰©ç†ç©ºç™½ã€ã¨ã€Œpaddingã€ãŒç›¸æ®ºã•ã‚Œã€2è¡Œç›®ã¨æ–‡é ­ãŒæƒã„ã¾ã™ */
    text-indent: calc(var(--indent-level, 0) * -0.6em - 1.2em) !important;
    
    position: relative;
    display: block;
}

/* 2. ã¶ã‚‰ä¸‹ã’ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã®å†å®šç¾© */
.CodeMirror-line:has(.cm-link) {
    /* å…¨ã¦ã®è¡Œã‚’ã€ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãƒ¬ãƒ™ãƒ«ã«å¿œã˜ãŸåˆ†ã ã‘å³ã«å¯„ã›ã‚‹ */
    /* 0.55em ã¯ 12px ã«ãŠã‘ã‚‹åŠè§’ã‚¹ãƒšãƒ¼ã‚¹ã®å¹…ã«æ¥µã‚ã¦è¿‘ã„æ•°å€¤ã§ã™ */
    padding-left: calc(var(--indent-level, 0) * 1em + 4.48em) !important;
    
    /* 1è¡Œç›®ã ã‘ã€CodeMirrorãŒæŒ¿å…¥ã—ãŸã€Œç‰©ç†çš„ãªç©ºç™½ã€ã®åˆ†ã ã‘å·¦ã«æˆ»ã™ */
    /* ã“ã‚Œã§ã€Œç‰©ç†ç©ºç™½ã€ã¨ã€Œpaddingã€ãŒç›¸æ®ºã•ã‚Œã€2è¡Œç›®ã¨æ–‡é ­ãŒæƒã„ã¾ã™ */
    text-indent: calc(var(--indent-level, 0) * -0.6em - 3.65em) !important;
    
    position: relative;
    display: block;
}

/* 3. æœ¬æ–‡ãŒæ¶ˆãˆãªã„ã‚ˆã†ã€spanã®è¨­å®šã‚’ãƒªã‚»ãƒƒãƒˆ */
.CodeMirror-line > span {
    display: inline;
    width: auto !important;
    opacity: 1 !important;
    letter-spacing: normal !important;
}

#menu-btn {
  background: none;
  border: none;
  font-size: 20px;
  padding: 4px;
  cursor: pointer;
}

#menu-panel {
  position: fixed;
  top: 50px;
  left: 8px;
  background: white;
  border: 1px solid #d1d1d6;
  border-radius: 8px;
  padding: 8px;
  z-index: 2000;
}

/* ===== å…¨ä½“ãƒ•ãƒ¬ãƒ¼ãƒ  ===== */
#app-frame {
  position: relative;
  height: 100%;
}

/* ===== PCå¹…å¯¾å¿œ ===== */
@media (min-width: 768px) {
  #app-frame {
    max-width: 900px;        /* â† å¥½ã¿ã§ 800ã€œ1100 */
    margin: 0 auto;
    box-shadow: 0 0 0 1px #e5e5ea;
    background: #fff;
  }

  body {
    background: #e5e5ea;
  }
}

.title-wrapper {
  position: relative;
  
}

/* å…±é€šï¼šå††ã®è¦‹ãŸç›® */
.sync-indicator {
  position: absolute;
  right: 8px;
  top: 50%;
  transform: translateY(-50%);

  width: 14px;
  height: 14px;
  border-radius: 50%;
  box-sizing: border-box;

  pointer-events: none;
}

/* ===== çŠ¶æ…‹åˆ¥ ===== */

/* åŒæœŸä¸­ï¼šã‚¹ãƒ”ãƒŠãƒ¼ */
.sync-indicator.syncing {
  border: 2px solid #ccc;
  border-top-color: #666;
  animation: spin 0.8s linear infinite;
}

/* ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ï¼šç·‘ */
.sync-indicator.online {
  background: #34c759; /* iOSã‚°ãƒªãƒ¼ãƒ³ */
}

/* ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ï¼šèµ¤ */
.sync-indicator.offline {
  background: #ff3b30; /* iOSãƒ¬ãƒƒãƒ‰ */
}

/* éè¡¨ç¤º */
.hidden {
  display: none;
}

/* å›è»¢ã¯ rotate ã®ã¿ */
@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}


  </style>
</head>

<body>
	<div id="app-frame">
  <div id="header-container">
    <div class="header-side"><button id="menu-btn">â˜°</button></div>
<div class="title-wrapper">
  <input id="title-field" type="text" placeholder="æ—¥ä»˜" />

  <div id="title-indicator" class="sync-indicator hidden"></div>
</div>
    
    <div class="header-side">
      <button id="export-all-btn">ğŸ“¤</button>
    </div>
  </div>

  <div id="toolbar">
    <div class="spacer"></div>
    <button id="diary-block-btn">ğŸ““</button>
    <button id="select-block-btn">ğŸ“</button>
    <span class="separator"></span>
    <button id="paste-btn">ğŸ“‹</button>
    <button id="checkbox-btn">âœ”ï¸</button>
    <button id="outdent-btn">â—€</button>
    <button id="indent-btn">â–¶</button>
    <button id="move-up-btn">â–²</button>
    <button id="move-down-btn">â–¼</button>
  </div>

  <div id="editor-container">
    <textarea id="editor"></textarea>
  </div>
	
	<div id="menu-panel" hidden>
  <button id="login-btn">Login</button>
  <button id="logout-btn" hidden>Logout</button>
  <div id="user-info"></div>
</div>
</div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/markdown/markdown.min.js"></script>
	<link rel="stylesheet" href="codemirror/lib/codemirror.css">
<script src="codemirror/lib/codemirror.js"></script>
<script src="codemirror/mode/markdown/markdown.js"></script>

<script type="module" src="app.js"></script>

  <!-- æ—¢å­˜ã®ãƒ­ã‚¸ãƒƒã‚¯ -->
  <script type="module" src="app.js"></script>

  <!-- iOS PWA ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å¯¾ç­– -->
  <script>
    const header = document.getElementById('header-container');
    const toolbar = document.getElementById('toolbar');

    function fixForKeyboard() {
      if (!window.visualViewport) return;
      const offset = window.visualViewport.offsetTop;
      header.style.transform = `translateY(${offset}px)`;
      toolbar.style.transform = `translateY(${offset}px)`;
    }

    window.visualViewport?.addEventListener('resize', fixForKeyboard);
    window.visualViewport?.addEventListener('scroll', fixForKeyboard);
    fixForKeyboard();
  </script>

</body>
</html>